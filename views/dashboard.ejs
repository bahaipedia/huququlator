<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Dashboard</title>
    <link rel="stylesheet" href="/styles.css">
    <link rel="stylesheet" href="/dashboard.css">
</head>
<body>
    <%- include('partials/sidebar', { loggedIn: loggedIn }) %>
    <div class="dashboard-page-wrapper">
        <h1 class="dashboard-title">Dashboard</h1>

        <!-- Dashboard Layout -->
        <div class="dashboard-layout-wrapper">
            <!-- Dashboard Table Wrapper -->
            <div class="dashboard-table-wrapper">
                <table class="dashboard-table">
                    <thead>
                        <tr>
                            <th>Accounts</th>
                            <th>Year 2021</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Assets Section -->
                        <tr class="section-row">
                            <td colspan="2" class="section-title">Assets</td>
                        </tr>
                        <tr>
                            <td>Bitcoin</td>
                            <td><input type="text" value="8833.22"></td>
                        </tr>
                        <tr>
                            <td>Ethereum</td>
                            <td><input type="text" value="3113.92"></td>
                        </tr>
                        <tr>
                            <td>Chase Checking</td>
                            <td><input type="text" value="3408.25"></td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <button class="add-item-button asset-button">Add a New Asset</button>
                            </td>
                        </tr>

                        <!-- Debts Section -->
                        <tr class="section-row">
                            <td colspan="2" class="section-title">Debts</td>
                        </tr>
<tr>
    <td>American Express</td>
    <td class="debt-input-wrapper">
        (<input type="text" value="200000">)
    </td>
</tr>
<tr>
    <td>Student Loan</td>
    <td class="debt-input-wrapper">
        (<input type="text" value="50000">)
    </td>
</tr>
                        <tr>
                            <td colspan="2">
                                <button class="add-item-button debt-button">Add a New Debt</button>
                            </td>
                        </tr>

                        <!-- Property Section -->
                        <tr class="section-row">
                            <td colspan="2" class="section-title">Property</td>
                        </tr>
                        <tr>
                            <td>Rental Apartment</td>
                            <td><input type="text" value="120000"></td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <button class="add-item-button property-button">Add a New Property</button>
                            </td>
                        </tr>

                        <!-- Unnecessary Expenses Section -->
                        <tr class="section-row">
                            <td colspan="2" class="section-title">Unnecessary Expenses</td>
                        </tr>
                        <tr>
                            <td>Streaming Subscriptions</td>
                            <td><input type="text" value="120"></td>
                        </tr>
                        <tr>
                            <td>Coffee Shop Visits</td>
                            <td><input type="text" value="300"></td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <button class="add-item-button expense-button">Add a New Expense</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Add Year Button -->
            <div class="add-year-button-wrapper">
                <button class="add-year-button">Add a New Year</button>
            </div>
        </div>

        <!-- Summary Section -->
        <div class="summary-section-wrapper">
            <h2 class="summary-section-title">Summary</h2>
    <table class="summary-table">
        <thead>
            <tr>
                <th>Summary</th>
                <th>Year 2021</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Total Assets:</td>
                <td>$131,355.39</td>
            </tr>
            <tr>
                <td>Total Debts:</td>
                <td class="debt-value">($20,018.97)</td>
            </tr>
            <tr>
                <td>Unnecessary Expenses:</td>
                <td>$420.00</td>
            </tr>
            <tr>
                <td>Previous Years Huquq:</td>
                <td class="debt-value">($5,000.00)</td>
            </tr>
            <tr>
                <td>Summary:</td>
                <td>$105,916.42</td>
            </tr>
            <tr>
                <td>Gold Rate:</td>
                <td>$1,800.00</td>
            </tr>
            <tr>
                <td>Units of Huquq:</td>
                <td>10.5</td>
            </tr>
            <tr>
                <td>Rounded Units:</td>
                <td>11</td>
            </tr>
            <tr>
                <td>Payment Due On:</td>
                <td>12/31/2021</td>
            </tr>
            <tr>
                <td>Huquq Payment Owed:</td>
                <td>$500.00</td>
            </tr>
            <tr>
                <td>Huquq Payments Made:</td>
                <td>$300.00</td>
            </tr>
            <tr>
                <td>Remainder Due:</td>
                <td>$200.00</td>
            </tr>
        </tbody>
    </table>
        </div>
    </div>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const debtInputs = document.querySelectorAll('.dashboard-table tbody input');

        debtInputs.forEach(input => {
            // Check if the input belongs to a debt row
            if (input.closest('tr').previousElementSibling?.classList.contains('section-title') &&
                input.closest('tr').previousElementSibling.textContent.trim() === 'Debts') {
                formatDebtInput(input); // Format existing value on page load

                input.addEventListener('input', () => {
                    formatDebtInput(input);
                });
            }
        });

        function formatDebtInput(input) {
            const value = parseFloat(input.value.replace(/[^0-9.]/g, '')); // Strip formatting
            if (!isNaN(value)) {
                input.style.color = 'red';
                input.value = `(${value.toLocaleString()})`; // Add parentheses and format with commas
            } else {
                input.style.color = '';
                input.value = '';
            }
        }
    });
</script>
</body>
</html>
